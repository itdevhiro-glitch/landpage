<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Zeppelin Portal</title>
    <!-- Impor Font (Roboto) dan Ikon (Font Awesome) -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        /* CSS Reset dan Pengaturan Dasar */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f9fafb; /* Latar belakang putih gading */
            color: #1f2937;
            line-height: 1.6;
        }
        .container {
            width: 100%;
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #D9232D 0%, #F37321 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
            z-index: 9999;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        .loading-screen p {
            margin-top: 20px;
            font-size: 1.1rem;
            font-weight: 300;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* --- Navbar Atas --- */
        .navbar {
            background-color: #ffffff;
            padding: 16px 24px;
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1280px;
            margin: 0 auto;
        }
        .nav-logo {
            font-size: 1.8rem;
            font-weight: 900;
            color: #D9232D;
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        .nav-logo i {
            color: #F37321;
            margin-right: 8px;
            font-size: 1.5rem;
        }
        .nav-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        /* Ikon Pintasan */
        .nav-shortcuts {
            display: flex;
            gap: 15px;
            border-right: 1px solid #e5e7eb;
            padding-right: 20px;
        }
        .shortcut-icon {
            font-size: 1.1rem;
            color: #6b7280;
            text-decoration: none;
            position: relative; /* Untuk Tooltip */
            transition: color 0.3s ease;
        }
        .shortcut-icon:hover {
            color: #D9232D;
        }
        .shortcut-icon .tooltip {
            visibility: hidden;
            opacity: 0;
            background-color: #1f2937;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 10px;
            position: absolute;
            z-index: 1;
            bottom: 140%;
            left: 50%;
            margin-left: -50px;
            font-size: 0.8rem;
            font-weight: 400;
            white-space: nowrap;
            transition: opacity 0.3s;
        }
        .shortcut-icon:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        /* Profil Pengguna & Logout */
        .nav-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        #user-greeting {
            font-size: 0.95rem;
            color: #4b5563;
        }
        #user-greeting span {
            font-weight: 700;
            color: #1f2937;
        }
        .logout-button {
            background: none;
            border: 1px solid #e5e7eb;
            color: #D9232D;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        .logout-button:hover {
            background-color: #D9232D;
            color: #ffffff;
            border-color: #D9232D;
        }

        /* --- Hero Section --- */
        .hero {
            background-color: #ffffff;
            padding: 80px 0;
            border-bottom: 1px solid #e5e7eb;
            overflow: hidden;
        }
        .hero-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .hero-text {
            flex: 1;
            max-width: 50%;
        }
        .hero-text h1 {
            font-size: 3.5rem;
            font-weight: 900;
            color: #1f2937;
            line-height: 1.2;
            margin-bottom: 20px;
        }
        .hero-text h1 span {
            color: #D9232D;
        }
        .hero-text p {
            font-size: 1.1rem;
            color: #4b5563;
            margin-bottom: 30px;
            max-width: 500px;
        }
        .hero-button {
            display: inline-block;
            background-color: #D9232D;
            color: #ffffff;
            padding: 14px 28px;
            font-size: 1rem;
            font-weight: 700;
            text-decoration: none;
            border-radius: 8px;
            transition: background-color 0.3s ease, transform 0.3s ease;
            box-shadow: 0 4px 15px rgba(217, 35, 45, 0.2);
            animation: pulse 2s infinite;
        }
        .hero-button:hover {
            background-color: #B01B22;
            transform: translateY(-2px);
            animation: none;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(217, 35, 45, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(217, 35, 45, 0); }
            100% { box-shadow: 0 0 0 0 rgba(217, 35, 45, 0); }
        }

        .hero-visual {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .icon-spinner {
            width: 350px;
            height: 350px;
            border-radius: 50%;
            background-color: #fff7f2; /* Oranye sangat muda */
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: spin 30s linear infinite;
        }
        .icon-spinner .center-icon {
            font-size: 8rem;
            color: #F37321;
        }
        /* --- End Hero --- */

        /* Portal Aplikasi Utama */
        .portal-section {
            padding: 40px 0;
            background-color: #f9fafb;
        }
        .portal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
        }
        .portal-card {
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 24px;
            text-decoration: none;
            color: #1f2937;
            transition: all 0.3s ease;
        }
        .portal-card:hover {
            transform: translateY(-5px);
            border-color: #D9232D;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }
        .portal-icon {
            font-size: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        .icon-red { background-color: #fee2e2; color: #D9232D; }
        .icon-orange { background-color: #fff7ed; color: #F37321; }
        .icon-gray { background-color: #f3f4f6; color: #4b5563; }

        .portal-card h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .portal-card p {
            font-size: 0.9rem;
            color: #6b7280;
            flex-grow: 1;
            margin-bottom: 20px;
        }
        .portal-link {
            font-weight: 700;
            color: #D9232D;
        }
        .portal-link i {
            margin-left: 5px;
            transition: margin-left 0.3s ease;
        }
        .portal-card:hover .portal-link i {
            margin-left: 10px;
        }
        /* --- End Portal Aplikasi --- */


        /* --- Konten Utama (Alat & Widget) --- */
        .main-content {
            padding: 60px 0;
        }
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr; /* Kolom kiri lebih lebar */
            gap: 32px;
        }

        /* Kolom Kiri: Alat */
        .portal-column h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 24px;
            border-left: 4px solid #D9232D;
            padding-left: 12px;
        }
        .portal-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 40px; /* Jarak antara Portal & Alat */
        }
        .portal-list a {
            display: flex;
            align-items: center;
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            text-decoration: none;
            color: #1f2937;
            transition: all 0.3s ease;
        }
        .portal-list a:hover {
            transform: translateX(5px);
            border-color: #D9232D;
            box-shadow: 4px 4px 0 0 #fee2e2;
        }
        .portal-list a:hover .link-arrow {
            transform: translateX(5px);
            color: #D9232D;
        }
        .link-icon {
            font-size: 1.5rem;
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 20px;
        }
        .link-text h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 2px;
        }
        .link-text p {
            font-size: 0.9rem;
            color: #6b7280;
        }
        .link-arrow {
            margin-left: auto;
            font-size: 1.2rem;
            color: #9ca3af;
            transition: all 0.3s ease;
        }
        
        /* Kolom Kanan: Widget */
        .widget-column {
            display: flex;
            flex-direction: column;
            gap: 32px;
        }
        .widget-card {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            overflow: hidden; /* Agar rapi */
        }
        .widget-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
        }
        .widget-header h3 {
            font-size: 1.2rem;
            font-weight: 700;
        }
        .widget-body {
            padding: 24px;
        }
        
        /* Widget Jam */
        #clock-widget {
            text-align: center;
        }
        .digital-clock {
            font-size: 2.5rem;
            font-weight: 700;
            color: #D9232D;
        }
        .digital-date {
            font-size: 1rem;
            color: #6b7280;
        }

        /* Widget Kalender */
        #calendar-widget {
            font-size: 0.9rem;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        #month-year {
            font-size: 1.1rem;
            font-weight: 700;
            color: #1f2937;
        }
        .cal-nav button {
            background: none;
            border: 1px solid #e5e7eb;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .cal-nav button:hover {
            background-color: #f9fafb;
            color: #D9232D;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }
        .calendar-grid div {
            text-align: center;
            padding: 8px;
        }
        .day-name {
            font-weight: 700;
            color: #6b7280;
        }
        .day-cell {
            cursor: pointer;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        .day-cell:hover:not(.empty) {
            background-color: #fee2e2;
            color: #D9232D;
        }
        .empty {
            opacity: 0.3;
        }
        .today {
            background-color: #D9232D;
            color: #ffffff;
            font-weight: 700;
        }
        /* --- End Konten Utama --- */

        /* --- Footer --- */
        .footer {
            text-align: center;
            padding: 40px 24px;
            background-color: #ffffff;
            border-top: 1px solid #e5e7eb;
            margin-top: 60px;
            color: #6b7280;
            font-size: 0.9rem;
        }
        .footer p {
            margin-bottom: 8px;
        }
        .footer a {
            color: #D9232D;
            text-decoration: none;
            font-weight: 500;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        /* --- End Footer --- */

        /* Animasi Fade-in-up */
        .fade-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-in-up.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* ========================================
        [BARU] Media Queries untuk Mobile
        ========================================
        */
        @media (max-width: 768px) {
            .container {
                padding: 0 16px;
            }

            /* --- Navbar --- */
            .nav-shortcuts {
                display: none; /* Sembunyikan pintasan di mobile */
            }
            #user-greeting {
                display: none; /* Sembunyikan sapaan, sisakan tombol logout */
            }
            .nav-right {
                gap: 10px;
            }

            /* --- Hero Section --- */
            .hero {
                padding: 40px 0; /* Kurangi padding */
                text-align: center; /* Pusatkan teks */
            }
            .hero-container {
                flex-direction: column; /* Susun ke bawah */
                gap: 30px; /* [DIUBAH] Mengurangi gap */
            }
            .hero-text {
                max-width: 100%; /* Lebar penuh */
            }
            .hero-text h1 {
                font-size: 2.5rem; /* Kecilkan font H1 */
            }
            .hero-text p {
                font-size: 1rem;
                max-width: 100%;
            }
            .icon-spinner {
                width: 250px; /* Kecilkan ikon berputar */
                height: 250px;
            }
            .icon-spinner .center-icon {
                font-size: 6rem;
            }

            /* --- Portal Aplikasi (Grid 4 kartu) --- */
            .portal-grid {
                grid-template-columns: 1fr; /* [BARU] Paksa 1-kolom di mobile agar rapi */
            }

            /* --- Konten Utama (Alat & Widget) --- */
            .main-content {
                padding: 40px 0;
            }
            .main-grid {
                grid-template-columns: 1fr; /* Susun ke bawah */
                gap: 40px;
            }

            /* [BARU] Rampingkan list "Alat Bantu" */
            .portal-list a {
                padding: 15px; /* Kurangi padding */
            }
            .link-icon {
                width: 40px; /* Kecilkan ikon */
                height: 40px;
                font-size: 1.2rem;
                margin-right: 15px;
            }

            /* [BARU] Rampingkan Widget Jam & Kalender */
            .widget-body {
                padding: 20px; /* Kurangi padding body widget */
            }
            .digital-clock {
                font-size: 2.2rem; /* Kecilkan font jam */
            }
            #calendar-widget {
                font-size: 0.8rem; /* Kecilkan font kalender */
            }
            .calendar-grid {
                gap: 5px; /* Kurangi gap antar tanggal */
            }
            .calendar-grid div {
                padding: 5px; /* Kurangi padding tanggal */
            }
            .cal-nav button {
                width: 25px; /* Kecilkan tombol nav */
                height: 25px;
            }
            /* --- End Rampingkan Widget --- */


            /* --- Ukuran Teks Lainnya --- */
            .portal-column h2 {
                font-size: 1.3rem;
            }
            .link-text h3 {
                font-size: 1rem;
            }
            .portal-card h3 {
                font-size: 1.2rem;
            }

            /* --- Footer --- */
            .footer {
                margin-top: 40px;
                padding-left: 16px;
                padding-right: 16px;
            }
        }
        
    </style>
</head>
<body>

    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="spinner"></div>
        <p>Memuat Portal...</p>
    </div>

    <!-- Konten Utama (Disembunyikan awalnya) -->
    <div id="main-content" style="display: none;">

        <!-- Navbar Atas -->
        <nav class="navbar">
            <div class="nav-container">
                <a href="#" class="nav-logo">
                    <i class="fa-solid fa-gear"></i> ZEPPELIN
                </a>
                
                <div class="nav-right">
                    <!-- Ikon Pintasan -->
                    <div class="nav-shortcuts">
                        <a href="https://itdevhiro-glitch.github.io/workspace-itsupport/user.html" target="_blank" class="shortcut-icon">
                            <i class="fa-solid fa-headset"></i>
                            <span class="tooltip">Layanan IT</span>
                        </a>
                        <a href="#" class="shortcut-icon">
                            <i class="fa-solid fa-file-invoice-dollar"></i>
                            <span class="tooltip">Keuangan</span>
                        </a>
                        <a href="#" class="shortcut-icon">
                            <i class="fa-solid fa-bullhorn"></i>
                            <span class="tooltip">Pemasaran</span>
                        </a>
                        <a href="#" class="shortcut-icon">
                            <i class="fa-solid fa-boxes-stacked"></i>
                            <span class="tooltip">Stok</span>
                        </a>
                    </div>

                    <!-- Profil & Logout -->
                    <div class="nav-profile">
                        <div id="user-greeting">Halo, <span>Tamu</span></div>
                        <button id="logout-btn" class="logout-button">
                            <i class="fa-solid fa-right-from-bracket"></i> Keluar
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero">
            <div class="container hero-container">
                <div class="hero-text fade-in-up">
                    <h1>Selamat Datang di <span>Portal Zeppelin</span></h1>
                    <p>Semua aplikasi dan alat bantu yang Anda butuhkan untuk produktivitas, kini terintegrasi di satu tempat.</p>
                    <a href="#portal-section" class="hero-button">Lihat Aplikasi Anda</a>
                </div>
                <div class="hero-visual fade-in-up">
                    <div class="icon-spinner">
                        <i class="fa-solid fa-blender-phone center-icon"></i>
                    </div>
                </div>
            </div>
        </section>

        <!-- Portal Aplikasi Utama -->
        <section class="portal-section" id="portal-section">
            <div class="container">
                <div class="portal-grid">
                    <!-- Kartu Portal 1 -->
                    <a href="https://itdevhiro-glitch.github.io/workspace-itsupport/user.html" target="_blank" class="portal-card fade-in-up" style="transition-delay: 100ms;">
                        <div class="portal-icon icon-red">
                            <i class="fa-solid fa-headset"></i>
                        </div>
                        <h3>Layanan IT (Helpdesk)</h3>
                        <p>Buat laporan kendala atau ajukan permintaan dukungan teknis baru.</p>
                        <span class="portal-link">Buka Aplikasi <i class="fa-solid fa-arrow-right"></i></span>
                    </a>
                    <!-- Kartu Portal 2 -->
                    <a href="#" class="portal-card fade-in-up" style="transition-delay: 200ms;">
                        <div class="portal-icon icon-gray">
                            <i class="fa-solid fa-file-invoice-dollar"></i>
                        </div>
                        <h3>Manajemen Keuangan</h3>
                        <p>Akses data akuntansi, anggaran, dan laporan finansial perusahaan.</p>
                        <span class="portal-link">Buka Aplikasi <i class="fa-solid fa-arrow-right"></i></span>
                    </a>
                    <!-- Kartu Portal 3 -->
                    <a href="#" class="portal-card fade-in-up" style="transition-delay: 300ms;">
                        <div class="portal-icon icon-gray">
                            <i class="fa-solid fa-bullhorn"></i>
                        </div>
                        <h3>Manajemen Konten</h3>
                        <p>Kelola aset digital, materi pemasaran, dan konten website.</p>
                        <span class="portal-link">Buka Aplikasi <i class="fa-solid fa-arrow-right"></i></span>
                    </a>
                    <!-- Kartu Portal 4 -->
                    <a href="#" class="portal-card fade-in-up" style="transition-delay: 400ms;">
                        <div class="portal-icon icon-gray">
                            <i class="fa-solid fa-boxes-stacked"></i>
                        </div>
                        <h3>Manajemen Stok</h3>
                        <p>Pantau ketersediaan barang, produksi, dan logistik inventaris.</p>
                        <span class="portal-link">Buka Aplikasi <i class="fa-solid fa-arrow-right"></i></span>
                    </a>
                </div>
            </div>
        </section>

        <!-- Konten Utama (Alat & Widget) -->
        <main class="main-content container">
            <div class="main-grid">
                
                <!-- Kolom Kiri: Alat Bantu Cepat -->
                <div class="portal-column">
                    <h2 class="fade-in-up">Alat Bantu Cepat</h2>
                    <div class="portal-list">
                        <a href="https://itdevhiro-glitch.github.io/widget/asset.html" target="_blank" class="fade-in-up" style="transition-delay: 100ms;">
                            <i class="link-icon icon-orange fa-solid fa-server"></i>
                            <div class="link-text">
                                <h3>Asset IT</h3>
                                <p>Widget untuk melihat dan mengelola data aset.</p>
                            </div>
                            <i class="link-arrow fa-solid fa-arrow-right"></i>
                        </a>
                        <a href="https://itdevhiro-glitch.github.io/widget/serah terima.html" target="_blank" class="fade-in-up" style="transition-delay: 200ms;">
                            <i class="link-icon icon-orange fa-solid fa-file-signature"></i>
                            <div class="link-text">
                                <h3>BAST Perangkat IT</h3>
                                <p>Formulir digital untuk Berita Acara Serah Terima.</p>
                            </div>
                            <i class="link-arrow fa-solid fa-arrow-right"></i>
                        </a>
                        <a href="https://itdevhiro-glitch.github.io/widget/excel inspector.html" target="_blank" class="fade-in-up" style="transition-delay: 300ms;">
                            <i class="link-icon icon-orange fa-solid fa-file-excel"></i>
                            <div class="link-text">
                                <h3>Excel Inspector</h3>
                                <p>Alat bantu untuk pengecekan dan validasi data Excel.</p>
                            </div>
                            <i class="link-arrow fa-solid fa-arrow-right"></i>
                        </a>
                    </div>
                </div>

                <!-- Kolom Kanan: Widget -->
                <div class="widget-column">
                    
                    <!-- Widget Jam -->
                    <div class="widget-card fade-in-up" style="transition-delay: 100ms;">
                        <div class="widget-header">
                            <h3>Jam & Tanggal</h3>
                        </div>
                        <div class="widget-body" id="clock-widget">
                            <div class="digital-clock">00:00:00</div>
                            <div class="digital-date">Memuat tanggal...</div>
                        </div>
                    </div>

                    <!-- Widget Kalender -->
                    <div class="widget-card fade-in-up" style="transition-delay: 200ms;">
                        <div class="widget-header">
                            <h3>Kalender</h3>
                        </div>
                        <div class="widget-body" id="calendar-widget">
                            <div class="calendar-header">
                                <div class="cal-nav">
                                    <button id="prev-month"><i class="fa-solid fa-chevron-left"></i></button>
                                </div>
                                <div id="month-year">...</div>
                                <div class="cal-nav">
                                    <button id="next-month"><i class="fa-solid fa-chevron-right"></i></button>
                                </div>
                            </div>
                            <div class="calendar-grid" id="calendar-days">
                                <!-- Akan diisi oleh JS -->
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2025 Zeppelin Manufacturing. Seluruh hak cipta dilindungi.</p>
            <p>Portal Internal dikelola oleh <a href="https://itdevhiro-glitch.github.io/itteam/" target="_blank">Tim IT</a>.</p>
        </footer>

    </div> <!-- End #main-content -->


    <!-- Script Firebase (Modular v10+) -->
    <script type="module">
        // Import functions
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        // Import Realtime Database
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

        // Konfigurasi Firebase Anda
        const firebaseConfig = {
            apiKey: "AIzaSyA9wgSalrlTcveIZi2i-WND86z1i9JYHKw",
            authDomain: "it-support-53eeb.firebaseapp.com",
            databaseURL: "https://it-support-53eeb-default-rtdb.firebaseio.com",
            projectId: "it-support-53eeb",
            storageBucket: "it-support-53eeb.firebasestorage.app",
            messagingSenderId: "573924501146",
            appId: "1:573924501146:web:12f34306ed675472322123",
            measurementId: "G-33K6DDE1VR"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app); // Inisialisasi Realtime Database

        // Elemen DOM
        const mainContent = document.getElementById('main-content');
        const loadingScreen = document.getElementById('loading-screen');
        const userGreeting = document.getElementById('user-greeting');
        const logoutBtn = document.getElementById('logout-btn');

        // --- AUTH GUARD & DATA LOADER ---
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // Pengguna sudah login
                console.log("Pengguna terautentikasi:", user.uid);
                userGreeting.innerHTML = `Halo, <span>${user.email}</span>`;
                
                // Coba ambil nama dari Realtime Database
                fetchUserName(user.uid);
                
                // Tampilkan konten utama dan sembunyikan loading
                mainContent.style.display = 'block';
                loadingScreen.style.display = 'none';

                // Inisialisasi semua widget
                runClock();
                initCalendar();
                
                // Aktifkan Intersection Observer untuk animasi
                initIntersectionObserver();

            } else {
                // Pengguna tidak login, redirect ke halaman login
                console.log("Pengguna tidak terautentikasi, mengalihkan...");
                window.location.href = 'login.html';
            }
        });

        // --- Fungsi Logout ---
        logoutBtn.addEventListener('click', () => {
            signOut(auth).then(() => {
                window.location.href = 'login.html';
            }).catch((error) => {
                console.error("Error logout:", error);
            });
        });

        // --- Fungsi Ambil Nama Pengguna ---
        function fetchUserName(uid) {
            const userRef = ref(db, 'users/' + uid + '/nama');
            onValue(userRef, (snapshot) => {
                const nama = snapshot.val();
                if (nama) {
                    userGreeting.innerHTML = `Halo, <span>${nama}</span>`;
                }
            }, (error) => {
                console.error("Gagal mengambil nama pengguna:", error);
            });
        }

        // --- Widget Jam ---
        function runClock() {
            const clockEl = document.querySelector('.digital-clock');
            const dateEl = document.querySelector('.digital-date');
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };

            function updateTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('id-ID', { hour12: false });
                const dateString = now.toLocaleDateString('id-ID', options);
                
                clockEl.textContent = timeString;
                dateEl.textContent = dateString;
            }
            updateTime();
            setInterval(updateTime, 1000);
        }

        // --- Widget Kalender ---
        let currentDate = new Date();
        function initCalendar() {
            const monthYearEl = document.getElementById('month-year');
            const daysEl = document.getElementById('calendar-days');
            const prevBtn = document.getElementById('prev-month');
            const nextBtn = document.getElementById('next-month');

            function renderCalendar() {
                const today = new Date();
                const month = currentDate.getMonth();
                const year = currentDate.getFullYear();
                
                monthYearEl.textContent = new Date(year, month).toLocaleDateString('id-ID', { month: 'long', year: 'numeric' });
                
                daysEl.innerHTML = ''; // Kosongkan kalender
                
                // Tambahkan nama hari
                const dayNames = ['Min', 'Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab'];
                dayNames.forEach(day => {
                    daysEl.innerHTML += `<div class="day-name">${day}</div>`;
                });
                
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                
                // Tambahkan sel kosong
                for (let i = 0; i < firstDay; i++) {
                    daysEl.innerHTML += `<div class="day-cell empty"></div>`;
                }
                
                // Tambahkan tanggal
                for (let i = 1; i <= daysInMonth; i++) {
                    let cellClass = "day-cell";
                    if (i === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                        cellClass += " today";
                    }
                    daysEl.innerHTML += `<div class="${cellClass}">${i}</div>`;
                }
            }
            
            prevBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });
            nextBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });
            
            renderCalendar();
        }

        // --- Animasi Scroll (Intersection Observer) ---
        function initIntersectionObserver() {
            const animatedElements = document.querySelectorAll('.fade-in-up');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target); // Animasi sekali saja
                    }
                });
            }, {
                threshold: 0.1 // Muncul saat 10% elemen terlihat
            });
            
            animatedElements.forEach(el => {
                observer.observe(el);
            });
        }

    </script>

</body>
</html>
